const users = {
  // Example user data
  "userRandomID": {
    id: "userRandomID",
    email: "user@example.com",
    password: "purple-monkey-dinosaur",
  },
  "user2RandomID": {
    id: "user2RandomID",
    email: "user2@example.com",
    password: "dishwasher-funk",
  },
};

app.post('/register', (req, res) => {
  const { email, password } = req.body;
  
  // Check if email or password is missing
  if (!email || !password) {
    return res.status(400).send("Email and password are required");
  }

  // Check if email already exists in users database
  for (const userId in users) {
    if (users[userId].email === email) {
      return res.status(400).send("Email already exists");
    }
  }

  // Generate a random user ID
  const userId = generateRandomString();

  // Add the new user to the users object
  users[userId] = {
    id: userId,
    email,
    password
  };

  // Set user_id cookie containing the user's ID
  res.cookie('user_id', userId);

  // Redirect to the /urls page
  res.redirect('/urls');
});

// Example of passing user object to template
app.get('/example', (req, res) => {
  const userId = req.cookies.user_id;
  const user = users[userId];
  res.render('example', { user });
});
